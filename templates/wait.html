{% extends "base.html" %} {% block title %}Waiting...{% endblock %} {% block
content %}

<div class="text-center mt-5">
  <h2 class="mb-4 text-body">‚è≥ Please Wait</h2>
  <p class="lead text-muted mb-4">
    Your file is being prepared. Please wait
    <span id="countdown">{{ seconds }}</span> seconds.
  </p>

  <div class="progress w-75 mx-auto mb-4" style="height: 25px">
    <div
      id="progressBar"
      class="progress-bar progress-bar-striped bg-info"
      role="progressbar"
      style="width: 0%"
      aria-valuenow="0"
      aria-valuemin="0"
      aria-valuemax="{{ seconds }}"
    ></div>
  </div>

  <p class="text-muted">
    The download will start automatically after the countdown.
  </p>
</div>

<script>
  let seconds = {{ seconds }};
  const countdownEl = document.getElementById("countdown");
  const progressEl = document.getElementById("progressBar");

  const interval = setInterval(() => {
    seconds--;
    countdownEl.textContent = seconds;
    const progress = 100 - (seconds / {{ seconds }}) * 100;
    progressEl.style.width = progress + "%";

    if (seconds <= 0) {
      clearInterval(interval);
      window.location.href = "/fetch_file/{{ uuid }}";
    }
  }, 1000);
</script>

{% endblock %}
